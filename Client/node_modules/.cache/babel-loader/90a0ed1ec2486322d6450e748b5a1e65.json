{"ast":null,"code":"var _slicedToArray = require(\"C:\\\\Users\\\\Addy\\\\OneDrive\\\\Documents\\\\React\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/slicedToArray\");\n\nvar React = require('react');\n\nmodule.exports = function useImage(url, crossOrigin) {\n  // lets use refs for image and status\n  // so we can update them during render\n  // to have instant update in status/image when new data comes in\n  var statusRef = React.useRef('loading');\n  var imageRef = React.useRef(); // we are not going to use token\n  // but we need to just to trigger state update\n\n  var _React$useState = React.useState(0),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      _ = _React$useState2[0],\n      setStateToken = _React$useState2[1]; // keep track of old props to trigger changes\n\n\n  var oldUrl = React.useRef();\n  var oldCrossOrigin = React.useRef();\n\n  if (oldUrl.current !== url || oldCrossOrigin.current !== crossOrigin) {\n    statusRef.current = 'loading';\n    imageRef.current = undefined;\n    oldUrl.current = url;\n    oldCrossOrigin.current = crossOrigin;\n  }\n\n  React.useLayoutEffect(function () {\n    if (!url) return;\n    var img = document.createElement('img');\n\n    function onload() {\n      statusRef.current = 'loaded';\n      imageRef.current = img;\n      setStateToken(Math.random());\n    }\n\n    function onerror() {\n      statusRef.current = 'failed';\n      imageRef.current = undefined;\n      setStateToken(Math.random());\n    }\n\n    img.addEventListener('load', onload);\n    img.addEventListener('error', onerror);\n    crossOrigin && (img.crossOrigin = crossOrigin);\n    img.src = url;\n    return function cleanup() {\n      img.removeEventListener('load', onload);\n      img.removeEventListener('error', onerror);\n    };\n  }, [url, crossOrigin]); // return array because it it better to use in case of several useImage hooks\n  // const [background, backgroundStatus] = useImage(url1);\n  // const [patter] = useImage(url2);\n\n  return [imageRef.current, statusRef.current];\n};","map":null,"metadata":{},"sourceType":"script"}